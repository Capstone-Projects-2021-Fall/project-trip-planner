<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8' />
  <link href='../lib/main.css' rel='stylesheet' />
  <script src='../lib/main.js'></script>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="common.css">
  <script>


  document.addEventListener('DOMContentLoaded', function() {



      //calculate how many days the trip is
      //var date1 = new Date(document.getElementById("startDate").value);//get from database
      //var date2 = new Date(document.getElementById("endDate").value);
      //var diffTime = Math.abs(date2 - date1);
      //var diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));


    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
      initialDate: '2021-10-00',
      initialView: 'timeGridAnyDay',
      nowIndicator: true,


      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
         right: 'timeGridAnyDay,listWeek' // buttons for switching between views
          },
          views: {
            timeGridAnyDay: {
              type: 'timeGrid',
              duration: { days: 4 },
              buttonText: 'Whole Trip'
            }
          },
      navLinks: true, // can click day/week names to navigate views
      editable: true,
      selectable: true,
      selectMirror: true,
      select: function(arg) {
        var title = prompt('Event Title:');
        if (title) {
          calendar.addEvent({
            title: title,
            start: arg.start,
            end: arg.end,
            allDay: arg.allDay
          })
        }
        calendar.unselect()
      },
      eventClick: function(arg) {
        if (confirm('Are you sure you want to delete this event?')) {
          arg.event.remove()
        }
      },
      dayMaxEvents: true, // allow "more" link when too many events
      events: []
    });
    var requestItinerary = {
        method: 'GET',
        headers: {
          "Access-Control-Allow-Headers":"*"
          }

      };
      // make API call with parameters and use promises to get response
      fetch("https://hhd3reswr9.execute-api.us-west-2.amazonaws.com/ItineraryManagement", requestItinerary).then(response => response.text()) // <---
      .then( function(data){let value = JSON.parse(data);
    console.log(value);
     let count = (Object.keys(value).length);
    for(let index = 0; index < count; index++){
      calendar.addEvent({
            title: value[index]["title"],
            start: Date.parse(value[index]["day"] + " " + value[index]["start"]),
            end: Date.parse(value[index]["day"] + " " + value[index]["end"])
          });
    } }//end data function

    );//end fetch.then





    calendar.render();
  });//end of dom content loaded



</script>
  <style>

  body {
    margin: 40px 10px;
    padding: 0;
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
    font-size: 14px;
  }
  button
  {
    margin: 0 auto;
    margin-left: 355px;
    margin-bottom: 10px;
    background-color: #2c3e50;
    color: white;
    padding: 0.4em 0.65em;
    border-radius: 0.25em;
    font-weight: 400;
    font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
    font-size: 14px;
  }

  #calendar {
    max-width: 1100px;
    margin: 0 auto;
  }



</style>
</head>
<body>


<!--  <button id="myBtn">Create Itinerary</button>-->
<!--  <button type="button">Save Itinerary</button>-->

<div id='calendar'></div>



<div class="w3-container w3-black w3-center w3-opacity w3-padding-64">
  <h1 class="w3-margin w3-xlarge">Quote of the Day: Live Collaboratively</h1>
</div>


</body>

<!-- Footer -->
<footer class="w3-container w3-padding-64 w3-center w3-opacity">
  <div class="w3-xlarge w3-padding-32">
  </div>

</footer>
</html>